ENUM role {
  RoleUser
  RoleAdmin
}

ENUM reaction_type {
  Like
  Dislike
}

TABLE core.countries {
  country_id SMALLSERIAL [pk]
  english_name TEXT [not null, unique]
  flag_key TEXT
}

TABLE core.cities {
  city_id SERIAL [pk]
  english_name TEXT [not null]
  country_id SMALLINT [ref: > core.countries.country_id, not null]
}

TABLE core.universities {
  university_id SMALLSERIAL [pk]
  original_name TEXT [not null]
  english_name TEXT
  link_to_website TEXT
  deleted_at TIMESTAMPTZ 
  city_id INTEGER [ref: > core.cities.city_id, not null]
}

TABLE core.fields_of_study {
  field_of_study_id SMALLSERIAL [pk]
  name TEXT [unique, not null]
}

TABLE core.user_statuses {
  user_status_id SMALLSERIAL [pk]
  name TEXT [not null]
}

TABLE core.user_credentials {
  user_id INTEGER [pk, ref: - core.users.user_id]
  username TEXT [unique, not null]
  password TEXT [not null]
}

TABLE core.user_descriptions {
  user_id INTEGER [pk, ref: - core.users.user_id]
  text_content TEXT [not null]
  updated_at TIMESTAMPTZ 
}

TABLE core.notification_settings {
  user_id INTEGER [pk, ref: - core.users.user_id]
  mail TEXT [unique]
  is_mail_notification_enabled BOOLEAN [not null]
}

TABLE core.users {
  user_id SERIAL [pk]
  nick TEXT [not null]
  avatar_key TEXT
  created_at TIMESTAMPTZ [not null]
  deleted_at TIMESTAMPTZ
  user_status_id SMALLINT [ref: > core.user_statuses.user_status_id]
  home_university_id SMALLINT [ref: > core.universities
  .university_id]
  country_of_origin_id SMALLINT [ref: > core.countries.country_id]
}

TABLE core.user_roles {
  user_id INTEGER [pk, ref: > core.user_credentials.user_id]
  role ROLE [pk]
}

TABLE core.university_reviews {
  university_review_id SERIAL [pk]
  text_content TEXT [not null]
  star_rating SMALLINT [not null]
  created_at TIMESTAMPTZ [not null]
  deleted_at TIMESTAMPTZ 
  author_id INTEGER [ref: > core.users.user_id, not null]
  university_id SMALLINT [ref: > core.universities
  .university_id, not null]
}

TABLE core.university_review_reactions {
  university_review_reaction_id BIGSERIAL [pk]
  reaction_type REACTION_TYPE [not null]
  university_review_id INTEGER [ref: > core.university_reviews.university_review_id, not null]
  author_id INTEGER [ref: > core.users.user_id, not null]
}

TABLE core.university_reviews_reaction_counts {
  university_review_id INTEGER [pk, ref: > core.university_reviews.university_review_id]
  reaction_type REACTION_TYPE [pk]
  count SMALLINT [not null]
}

TABLE core.user_follows {
  follower_id INTEGER [pk, ref: > core.users.user_id, not null]
  followee_id INTEGER [pk, ref: > core.users.user_id, not null]
}

TABLE core.university_follows {
  follower_id INTEGER [pk, ref: > core.users.user_id, not null]
  university_id SMALLINT [pk, ref: > core.universities
  .university_id, not null]
}

TABLE core.exchanges {
  exchange_id SERIAL [pk]
  started_at DATE [not null]
  end_at DATE [not null]
  user_id INTEGER [ref: > core.users.user_id, not null]
  field_of_study_id SMALLINT [ref: > core.fields_of_study.field_of_study_id, not null]
  university_id SMALLINT [ref: > core.universities
  .university_id, not null]
}

TABLE core.refresh_tokens {
  refresh_token_id UUID [pk]
  hashed_token TEXT [not null]
  created_at TIMESTAMPTZ [not null]
  expires_at TIMESTAMPTZ [not null]
  is_revoked BOOLEAN [not null]
  device_id UUID [not null]
  device_name TEXT
  ip_address TEXT
  user_id INTEGER [ref: > core.users.user_id, not null]
}



